
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Flex Gen Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../NSDI 2023/" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Preface</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Blogs</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../Blogs/Academic Writing/">
            
                <a href="../../Blogs/Academic Writing/">
            
                    
                    Academic Writing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../../Blogs/Academic Writing/design of system.html">
            
                <a href="../../Blogs/Academic Writing/design of system.html">
            
                    
                    Design Of System
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../Blogs/academic reading.html">
            
                <a href="../../Blogs/academic reading.html">
            
                    
                    Academic Reading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../Blogs/how to express.html">
            
                <a href="../../Blogs/how to express.html">
            
                    
                    How To Express
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Paper Reading Notes</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../Arxiv/">
            
                <a href="../Arxiv/">
            
                    
                    Arxiv
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../Arxiv/Mooncake.html">
            
                <a href="../Arxiv/Mooncake.html">
            
                    
                    Mooncake
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../Arxiv/S-LoRA.html">
            
                <a href="../Arxiv/S-LoRA.html">
            
                    
                    S-LoRA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../Arxiv/MemServe.md">
            
                <span>
            
                    
                    MemServe
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../ASPLOS 2024/">
            
                <a href="../ASPLOS 2024/">
            
                    
                    ASPLOS 2024
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../ASPLOS 2024/ExeGPT.html">
            
                <a href="../ASPLOS 2024/ExeGPT.html">
            
                    
                    Exe GPT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../ASPLOS 2024/SpecInfer.html">
            
                <a href="../ASPLOS 2024/SpecInfer.html">
            
                    
                    Spec Infer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../OSDI 2024/">
            
                <a href="../OSDI 2024/">
            
                    
                    OSDI 2024
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../OSDI 2024/Llumnix.html">
            
                <a href="../OSDI 2024/Llumnix.html">
            
                    
                    Llumnix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../OSDI 2024/ServerlessLLM.html">
            
                <a href="../OSDI 2024/ServerlessLLM.html">
            
                    
                    Serverless LLM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../OSDI 2024/Fairness in Serving LLM.md">
            
                <span>
            
                    
                    Fairness in Serving LLM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../SOSP 2024/">
            
                <a href="../SOSP 2024/">
            
                    
                    SOSP 2024
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="../SOSP 2024/Apparate.html">
            
                <a href="../SOSP 2024/Apparate.html">
            
                    
                    Apparate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="../SOSP 2024/LoongServe.html">
            
                <a href="../SOSP 2024/LoongServe.html">
            
                    
                    Loong Serve
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../FAST 2023/">
            
                <a href="../FAST 2023/">
            
                    
                    FAST 2023
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="../FAST 2023/Resource Scheduling for LC Services.html">
            
                <a href="../FAST 2023/Resource Scheduling for LC Services.html">
            
                    
                    Resource Scheduling For LC Services
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="./">
            
                <a href="./">
            
                    
                    ICML 2023
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="3.6.1" data-path="FlexGen.html">
            
                <a href="FlexGen.html">
            
                    
                    Flex Gen
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../NSDI 2023/">
            
                <a href="../NSDI 2023/">
            
                    
                    NSDI 2023
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.7.1" data-path="../NSDI 2023/Shockwave.html">
            
                <a href="../NSDI 2023/Shockwave.html">
            
                    
                    Shockwave
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="../SC 2023/">
            
                <a href="../SC 2023/">
            
                    
                    SC 2023
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.8.1" data-path="../SC 2023/AutoMap.html">
            
                <a href="../SC 2023/AutoMap.html">
            
                    
                    Auto Map
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="../SOSP 2023/">
            
                <a href="../SOSP 2023/">
            
                    
                    SOSP 2023
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.9.1" data-path="../SOSP 2023/vllm.html">
            
                <a href="../SOSP 2023/vllm.html">
            
                    
                    Vllm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="../OSDI 2022/">
            
                <a href="../OSDI 2022/">
            
                    
                    OSDI 2022
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.10.1" data-path="../OSDI 2022/Orca.html">
            
                <a href="../OSDI 2022/Orca.html">
            
                    
                    Orca
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="../SC 2022/">
            
                <a href="../SC 2022/">
            
                    
                    SC 2022
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.11.1" data-path="../SC 2022/CoGNN.html">
            
                <a href="../SC 2022/CoGNN.html">
            
                    
                    Co GNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.11.2" data-path="../SC 2022/VSGM.html">
            
                <a href="../SC 2022/VSGM.html">
            
                    
                    VSGM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="../OSDI 2020/">
            
                <a href="../OSDI 2020/">
            
                    
                    OSDI 2020
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.12.1" data-path="../OSDI 2020/Gavel.html">
            
                <a href="../OSDI 2020/Gavel.html">
            
                    
                    Gavel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.13" data-path="../SIGMOD 2020/">
            
                <a href="../SIGMOD 2020/">
            
                    
                    SIGMOD 2020
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.13.1" data-path="../SIGMOD 2020/GPU-based Subgraph Enumerations.html">
            
                <a href="../SIGMOD 2020/GPU-based Subgraph Enumerations.html">
            
                    
                    GPU Based Subgraph Enumerations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.14" data-path="../OSDI 2018/">
            
                <a href="../OSDI 2018/">
            
                    
                    OSDI 2018
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.14.1" data-path="../OSDI 2018/Ray.html">
            
                <a href="../OSDI 2018/Ray.html">
            
                    
                    Ray
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Study Notes</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../Study Notes/CME 213/">
            
                <a href="../../Study Notes/CME 213/">
            
                    
                    CME 213
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../../Study Notes/CME 213/C++.html">
            
                <a href="../../Study Notes/CME 213/C++.html">
            
                    
                    C
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../Study Notes/CUDA/">
            
                <a href="../../Study Notes/CUDA/">
            
                    
                    CUDA
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../../Study Notes/CUDA/CUDA Warp Level.html">
            
                <a href="../../Study Notes/CUDA/CUDA Warp Level.html">
            
                    
                    CUDA Warp Level
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../../Study Notes/CUDA/CUDA1 Basic.html">
            
                <a href="../../Study Notes/CUDA/CUDA1 Basic.html">
            
                    
                    CUDA 1 Basic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../../Study Notes/CUDA/CUDA2 Brief Summary.html">
            
                <a href="../../Study Notes/CUDA/CUDA2 Brief Summary.html">
            
                    
                    CUDA 2 Brief Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../../Study Notes/CUDA/CUDA3 Kernels.html">
            
                <a href="../../Study Notes/CUDA/CUDA3 Kernels.html">
            
                    
                    CUDA 3 Kernels
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../../Study Notes/CUDA/Nsight System.html">
            
                <a href="../../Study Notes/CUDA/Nsight System.html">
            
                    
                    Nsight System
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../Study Notes/LLM Parallelism/">
            
                <a href="../../Study Notes/LLM Parallelism/">
            
                    
                    LLM Parallelism
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../../Study Notes/LLM Parallelism/Data Parallelism.html">
            
                <a href="../../Study Notes/LLM Parallelism/Data Parallelism.html">
            
                    
                    Data Parallelism
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../../Study Notes/LLM Parallelism/Pipe Parallelism.html">
            
                <a href="../../Study Notes/LLM Parallelism/Pipe Parallelism.html">
            
                    
                    Pipe Parallelism
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../../Study Notes/LLM Parallelism/Tensor Parallelism.html">
            
                <a href="../../Study Notes/LLM Parallelism/Tensor Parallelism.html">
            
                    
                    Tensor Parallelism
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../../Study Notes/MIT 6.172/">
            
                <a href="../../Study Notes/MIT 6.172/">
            
                    
                    MIT 6.172
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.4.1" data-path="../../Study Notes/MIT 6.172/mit-6-172-1.html">
            
                <a href="../../Study Notes/MIT 6.172/mit-6-172-1.html">
            
                    
                    Mit 6 172 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.2" data-path="../../Study Notes/MIT 6.172/mit-6-172-12.html">
            
                <a href="../../Study Notes/MIT 6.172/mit-6-172-12.html">
            
                    
                    Mit 6 172 12
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.3" data-path="../../Study Notes/MIT 6.172/mit-6-172-2.html">
            
                <a href="../../Study Notes/MIT 6.172/mit-6-172-2.html">
            
                    
                    Mit 6 172 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.4" data-path="../../Study Notes/MIT 6.172/mit-6-172-3.html">
            
                <a href="../../Study Notes/MIT 6.172/mit-6-172-3.html">
            
                    
                    Mit 6 172 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.5" data-path="../../Study Notes/MIT 6.172/mit-6-172-hw2.html">
            
                <a href="../../Study Notes/MIT 6.172/mit-6-172-hw2.html">
            
                    
                    Mit 6 172 Hw 2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../../Study Notes/MLSYS/">
            
                <a href="../../Study Notes/MLSYS/">
            
                    
                    MLSYS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.5.1" data-path="../../Study Notes/MLSYS/Llama Model's Decoder Code.html">
            
                <a href="../../Study Notes/MLSYS/Llama Model's Decoder Code.html">
            
                    
                    Llama Model S Decoder Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.2" data-path="../../Study Notes/MLSYS/LLM Calculation.html">
            
                <a href="../../Study Notes/MLSYS/LLM Calculation.html">
            
                    
                    LLM Calculation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.3" data-path="../../Study Notes/MLSYS/LLM Deployment Record.html">
            
                <a href="../../Study Notes/MLSYS/LLM Deployment Record.html">
            
                    
                    LLM Deployment Record
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.4" data-path="../../Study Notes/MLSYS/Sepculative Decoding.html">
            
                <a href="../../Study Notes/MLSYS/Sepculative Decoding.html">
            
                    
                    Sepculative Decoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../../Study Notes/NLP/">
            
                <a href="../../Study Notes/NLP/">
            
                    
                    NLP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.6.1" data-path="../../Study Notes/NLP/Basics of Machine Learning.html">
            
                <a href="../../Study Notes/NLP/Basics of Machine Learning.html">
            
                    
                    Basics Of Machine Learning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.2" data-path="../../Study Notes/NLP/GPT.html">
            
                <a href="../../Study Notes/NLP/GPT.html">
            
                    
                    GPT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.3" data-path="../../Study Notes/NLP/Implementation Neural Network.html">
            
                <a href="../../Study Notes/NLP/Implementation Neural Network.html">
            
                    
                    Implementation Neural Network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.4" data-path="../../Study Notes/NLP/Loss Function.html">
            
                <a href="../../Study Notes/NLP/Loss Function.html">
            
                    
                    Loss Function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.5" data-path="../../Study Notes/NLP/Recurrent Neural Network.html">
            
                <a href="../../Study Notes/NLP/Recurrent Neural Network.html">
            
                    
                    Recurrent Neural Network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.6" data-path="../../Study Notes/NLP/Seq2Seq and Attention.html">
            
                <a href="../../Study Notes/NLP/Seq2Seq and Attention.html">
            
                    
                    Seq 2 Seq And Attention
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="../../Study Notes/OPENMP/">
            
                <a href="../../Study Notes/OPENMP/">
            
                    
                    OPENMP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.7.1" data-path="../../Study Notes/OPENMP/openmp.html">
            
                <a href="../../Study Notes/OPENMP/openmp.html">
            
                    
                    OPENMP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="../../Study Notes/Triton/">
            
                <a href="../../Study Notes/Triton/">
            
                    
                    Triton
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="../../Study Notes/Ray/index.md">
            
                <span>
            
                    
                    Ray
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="../../Study Notes/vLLM Code/">
            
                <a href="../../Study Notes/vLLM Code/">
            
                    
                    VLLM Code
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.10.1" data-path="../../Study Notes/vLLM Code/vllm-async-llm.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-async-llm.html">
            
                    
                    Vllm Async Llm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.2" data-path="../../Study Notes/vLLM Code/vllm-attention.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-attention.html">
            
                    
                    Vllm Attention
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.3" data-path="../../Study Notes/vLLM Code/vllm-block.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-block.html">
            
                    
                    Vllm Block
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.4" data-path="../../Study Notes/vLLM Code/vllm-cache.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-cache.html">
            
                    
                    Vllm Cache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.5" data-path="../../Study Notes/vLLM Code/vllm-chunked-prefill.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-chunked-prefill.html">
            
                    
                    Vllm Chunked Prefill
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.6" data-path="../../Study Notes/vLLM Code/vllm-cpu.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-cpu.html">
            
                    
                    Vllm Cpu
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.7" data-path="../../Study Notes/vLLM Code/vllm-llama.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-llama.html">
            
                    
                    Vllm Llama
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.8" data-path="../../Study Notes/vLLM Code/vllm-LoRA.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-LoRA.html">
            
                    
                    Vllm Lo RA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.9" data-path="../../Study Notes/vLLM Code/vllm-metadata.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-metadata.html">
            
                    
                    Vllm Metadata
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.10" data-path="../../Study Notes/vLLM Code/vllm-profile.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-profile.html">
            
                    
                    Vllm Profile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.11" data-path="../../Study Notes/vLLM Code/vllm-ray.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-ray.html">
            
                    
                    Vllm Ray
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10.12" data-path="../../Study Notes/vLLM Code/vllm-schedule.html">
            
                <a href="../../Study Notes/vLLM Code/vllm-schedule.html">
            
                    
                    Vllm Schedule
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.11" data-path="../../Study Notes/Llumnix Code/">
            
                <a href="../../Study Notes/Llumnix Code/">
            
                    
                    Llumnix Code
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.11.1" data-path="../../Study Notes/Llumnix Code/llumnix.html">
            
                <a href="../../Study Notes/Llumnix Code/llumnix.html">
            
                    
                    Llumnix
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.12" data-path="../../Study Notes/LoongServe Code/">
            
                <a href="../../Study Notes/LoongServe Code/">
            
                    
                    LoongServe Code
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Flex Gen</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="flexgen-high-throughput-generative-inference-of-large-language-models-with-a-single-gpu">FlexGen: High-Throughput Generative Inference of Large Language Models with a Single GPU</h1>
<p><a href="https://dl.acm.org/doi/10.5555/3618408.3619696" target="_blank">FlexGen</a></p>
<h2 id="abstract">Abstract</h2>
<blockquote>
<p>Motivated by the emerging demand for <strong>latency-insensitive tasks</strong> with batched processing, this paper initiates the study of high-throughput LLM inference using limited resources, such as a single commodity GPU.</p>
</blockquote>
<p>&#x672C;&#x6587;&#x7684;&#x4E3B;&#x8981;&#x662F;&#x9488;&#x5BF9;&#x89E3;&#x51B3;<strong>&#x5EF6;&#x8FDF;&#x4E0D;&#x654F;&#x611F;&#x4EFB;&#x52A1;</strong>&#x7684;&#x65B0;&#x5174;&#x9700;&#x6C42;&#xFF0C;&#x63D0;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x5728;GPU&#x5185;&#x5B58;&#x6709;&#x9650;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FDB;&#x884C;LLM&#x63A8;&#x7406;&#x7684;&#x9AD8;&#x541E;&#x5410;&#x91CF;&#x5F15;&#x64CE;&#x3002;</p>
<blockquote>
<p>By solving <strong>a linear programming problem</strong>, it searches for ef&#xFB01;cient patterns to store and access tensors.</p>
</blockquote>
<p>&#x901A;&#x8FC7;&#x7EBF;&#x6027;&#x89C4;&#x5212;&#x95EE;&#x9898;&#x6765;&#x641C;&#x7D22;<strong>&#x5982;&#x4F55;&#x5B58;&#x50A8;&#x548C;&#x8BBF;&#x95EE;&#x5F20;&#x91CF;</strong>&#x3002;</p>
<blockquote>
<p>FlexGen further compresses the weights and the attention cache to 4 bits with negligible accuracy loss.</p>
</blockquote>
<p><strong>&#x6A21;&#x578B;&#x91CF;&#x5316;</strong>&#xFF1A;&#x5728;&#x51E0;&#x4E4E;&#x6CA1;&#x6709;&#x7CBE;&#x5EA6;&#x635F;&#x5931;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5C06;weights&#x548C;attention cache&#x964D;&#x5230;4bit</p>
<blockquote>
<p>These techniques enable FlexGen to have a <strong>larger space of batch size</strong> choices and thus signi&#xFB01;cantly increase maximum throughput.</p>
</blockquote>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x8FF0;&#x65B9;&#x6CD5;&#xFF0C;FlexGen&#x6709;&#x7740;<strong>&#x66F4;&#x5927;&#x7684;batch size&#x5904;&#x7406;&#x7A7A;&#x95F4;</strong>&#x6765;&#x5B9E;&#x73B0;<strong>&#x66F4;&#x5927;&#x7684;&#x541E;&#x5410;&#x91CF;</strong></p>
<h2 id="introduction">Introduction</h2>
<p><strong>&#x5927;&#x6A21;&#x578B;&#x7684;&#x6311;&#x6218;</strong>&#xFF1A;</p>
<blockquote>
<p>These models can have billions, if not trillions of parameters (Chowdhery et al., 2022; Fedus et al., 2022), which leads to extremely high computational and memory requirements to run.</p>
<p>&#x5BF9;&#x8BA1;&#x7B97;&#x548C;&#x5185;&#x5B58;&#x8981;&#x6C42;&#x9AD8;</p>
</blockquote>
<p>-&gt; &#x5982;&#x4F55;&#x964D;&#x4F4E;LLM&#x63A8;&#x7406;&#x8D44;&#x6E90;&#x8981;&#x6C42;</p>
<p>-&gt;&#x672C;&#x6587;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x9762;&#x5411;&#x541E;&#x5410;&#x91CF;&#x7684;&#x751F;&#x6210;&#x63A8;&#x7406;</p>
<p><strong>&#x5F53;&#x524D;&#x7684;&#x9700;&#x6C42;</strong>&#xFF1A;</p>
<blockquote>
<p>One key characteristic of these tasks is that they often require running LLM inference in batches over a large number of tokens</p>
</blockquote>
<p>&#x5B58;&#x5728;&#x4E00;&#x90E8;&#x5206;&#x5927;&#x6A21;&#x578B;&#x63A8;&#x7406;&#xFF0C;&#x9700;&#x8981;&#x5BF9;&#x5927;&#x91CF;token&#x6279;&#x91CF;&#x8FD0;&#x884C;LLM&#x63A8;&#x7406;&#xFF0C;&#x4E14;&#x5BF9;&#x5EF6;&#x8FDF;&#x4E0D;&#x592A;&#x654F;&#x611F;&#x3002;</p>
<p><strong>&#x5148;&#x524D;&#x964D;&#x4F4E;LLM&#x8D44;&#x6E90;&#x9700;&#x6C42;&#x7684;&#x5DE5;&#x4F5C;</strong></p>
<blockquote>
<p>Prior efforts to lower resource requirements of LLM infer- ence correspond to three directions: </p>
<ol>
<li><p><strong>model compression</strong> to decrease total memory footprint (Dettmers et al., 2022; Yao et al., 2022; Frantar et al., 2022; Xiao et al., 2022); </p>
<p>&#x6A21;&#x578B;&#x538B;&#x7F29;</p>
</li>
<li><p><strong>collaborative inference</strong> to amortize inference cost via <strong>decentralization</strong> (Borzunov et al., 2022); </p>
<p>&#x5229;&#x7528;CPU&#x534F;&#x52A9;&#x63A8;&#x7406;</p>
</li>
<li><p><strong>of&#xFB02;oading</strong> to utilize memory from CPU and disk (Aminabadi et al., 2022; HuggingFace, 2022).</p>
<p>offload&#x5230;CPU&#x548C;disk&#x4E0A;</p>
</li>
</ol>
</blockquote>
<p><strong>&#x7F3A;&#x9677;</strong></p>
<blockquote>
<p>1&#x548C;2&#x5EFA;&#x7ACB;&#x5728;GPU&#x5185;&#x5B58;&#x80FD;&#x653E;&#x4E0B;&#x6A21;&#x578B;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF1A;&#x5F88;&#x96BE;&#x652F;&#x6301;&#x5355;&#x5361;&#x8FD0;&#x884C;175B&#x7684;&#x5927;&#x6A21;&#x578B;</p>
<p>3&#x7684;IO&#x8C03;&#x5EA6;&#x548C;tensor&#x653E;&#x7F6E;&#x4F7F;&#x5F97;&#x5176;&#x5728;&#x5355;&#x4E2A;GPU&#x4E0A;&#x6027;&#x80FD;&#x5F88;&#x5DEE;&#xFF1A;&#x5728;&#x5C0F;&#x6279;&#x91CF;&#x8981;&#x6C42;&#x4E0A;&#xFF0C;&#x53EF;&#x80FD;&#x6548;&#x679C;&#x5F88;&#x5DEE;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x63D0;&#x51FA;&#x89E3;&#x51B3;&#x65B9;&#x6848;</strong></p>
<blockquote>
<p>&#x5728;&#x5355;&#x4E2A;&#x5546;&#x7528;GPU&#x4E0A;&#x8BBE;&#x8BA1;&#x9AD8;&#x6548;&#x7684;&#x5378;&#x8F7D;&#x7B56;&#x7565;</p>
</blockquote>
<p><strong>&#x6311;&#x6218;</strong></p>
<blockquote>
<ol>
<li><p>&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x6709;&#x6548;&#x7684;&#x5378;&#x8F7D;&#x7B56;&#x7565;</p>
<p>&#x4E3B;&#x8981;&#x6709;&#x4E09;&#x79CD;tensors&#x9700;&#x8981;&#x5378;&#x8F7D;&#xFF1A;weights&#xFF0C;activations&#x548C;KV cache</p>
<p>&#x9700;&#x8981;&#x8003;&#x8651;&#xFF1A;what tensors to of&#xFB02;oad, where to of&#xFB02;oad them within the three-level memory hierarchy, and when to of&#xFB02;oad them during inference</p>
<p>The batch-by-batch, token-by-token, and layer-by-layer structure of the computation forms a complex dependency graph where there are multiple ways to conduct computation.</p>
</li>
<li><p>&#x5982;&#x4F55;&#x5236;&#x5B9A;&#x6709;&#x6548;&#x7684;&#x538B;&#x7F29;&#x7B56;&#x7565;</p>
<p>when combining compression with of&#xFB02;oading for high-throughput inference, the I/O costs and memory reduction of the weights and KV cache become more important</p>
</li>
</ol>
</blockquote>
<h2 id="related-work">Related Work</h2>
<blockquote>
<p>Recent years have witnessed the emergence of systems specialized for LLM inference, such as FasterTransformer (NVIDIA, 2022), Orca (Yu et al., 2022), LightSeq (Wang et al., 2021), PaLM inference (Pope et al., 2022), TurboTransformers (Fang et al., 2021), DeepSpeed Inference (Aminabadi et al., 2022), and Hugging Face Accelerate (HuggingFace, 2022).</p>
<p>&#x4F46;&#x5927;&#x591A;&#x6570;&#x90FD;&#x4E13;&#x6CE8;&#x4E8E;&#x5177;&#x6709;&#x9AD8;&#x7AEF;&#x52A0;&#x901F;&#x5668;<strong>&#x9762;&#x5411;&#x5EF6;&#x8FDF;</strong>&#x7684;&#x573A;&#x666F;&#xFF0C;&#x9650;&#x5236;&#x4E86;&#x5728;&#x5546;&#x54C1;&#x7EA7;GPU<strong>&#x9762;&#x5411;&#x541E;&#x5410;&#x91CF;</strong>&#x7684;&#x63A8;&#x7406;&#x7684;&#x90E8;&#x7F72;&#x3002;</p>
<p>To enable LLM inference on such commodity hardware, of&#xFB02;oading is an essential technique &#x2014; as far as we know, among current systems, only <strong>DeepSpeed Zero-Inference</strong> and <strong>Hugging Face Accelerate</strong> support of&#xFB02;oading.</p>
<p>&#x4F46;&#x90FD;&#x662F;&#x7EE7;&#x627F;&#x4E86;training systems&#x4E2D;&#x7684;offload&#x65B9;&#x6CD5;&#xFF0C;&#x5FFD;&#x7565;&#x4E86;&#x63A8;&#x7406;&#x7684;&#x8BA1;&#x7B97;&#x5C5E;&#x6027;&#x3002;</p>
<p>Another attempt to enable LLM inference on accessible hardware is collaborative computing proposed by Petals (Borzunov et al., 2022).</p>
<p>&#x534F;&#x4F5C;&#x8BA1;&#x7B97;</p>
<p>sparsi&#xFB01;cation (Hoe&#xFB02;er et al., 2021; Frantar &amp; Alistarh, 2023) and quantization (Kwon et al., 2022; Yao et al., 2022; Park et al., 2022; Xiao et al., 2022; Frantar et al., 2022; Dettmers et al., 2022)</p>
<p>&#x7A00;&#x758F;&#x5316;&#x548C;&#x91CF;&#x5316;</p>
<p>memory optimizations and of&#xFB02;oading have been studied for training (Huang et al., 2020; Ren et al., 2021; Steiner et al., 2022) and linear algebra (Jia-Wei &amp; Kung, 1981; Demmel, 2013).</p>
<p>&#x5185;&#x5B58;&#x4F18;&#x5316;&#x548C;&#x5378;&#x8F7D;&#x3001;&#x7EBF;&#x6027;&#x4EE3;&#x6570;</p>
</blockquote>
<h2 id="background">Background</h2>
<p><strong>Generative Inference</strong></p>
<blockquote>
<p>A typical LLM generative inference task consists of two stages: </p>
<ol>
<li>the pre&#xFB01;ll stage which takes a prompt sequence to generate the key-value cache (KV cache) for each transformer layer of the LLM;</li>
<li>the decoding stage which utilizes and updates the KV cache to generate tokens step-by-step, where the current token generation depends on previously generated tokens.</li>
</ol>
</blockquote>
<p>&#x5177;&#x4F53; to be continued</p>
<h2 id="of&#xFB02;oading-strategy">Of&#xFB02;oading Strategy</h2>
<blockquote>
<p><img src="FlexGen.assets/1.png" alt="1"></p>
</blockquote>
<p><strong>&#x5B9A;&#x4E49;&#x4E86;&#x4EE5;&#x4E0B;&#x7EA6;&#x675F;</strong></p>
<blockquote>
<ul>
<li><p>A square can only be computed if all squares to its left on the same row were computed.</p>
<p>&#x5DE6;&#x8FB9;&#x7684;&#x7B97;&#x5B8C;&#x624D;&#x80FD;&#x7B97;&#x53F3;&#x8FB9;&#x7684;</p>
</li>
<li><p>To compute a square on a device, all its inputs (weights, activations, cache) must be loaded to the same device.</p>
<p>&#x8F93;&#x5165;&#x9700;&#x8981;load&#x5230;&#x540C;&#x4E00;&#x4E2A;&#x8BBE;&#x5907;&#x4E0A;</p>
</li>
<li><p>After being computed, a square produces two outputs: activations and KV cache. The activations should be stored until its right sibling is computed. The KV cache should be stored until the rightmost square on the same row is computed. </p>
<p>&#x8BA1;&#x7B97;&#x540E;&#x751F;&#x6210;&#x6FC0;&#x6D3B;&#x503C;&#x548C;KV cache&#xFF0C;&#x6FC0;&#x6D3B;&#x503C;&#x5B58;&#x5230;&#x4E0B;&#x4E00;&#x5C42;&#x5B8C;&#x6210;&#x8BA1;&#x7B97;&#xFF0C;KV cache&#x5B58;&#x5230;&#x8BE5;&#x884C;&#x6240;&#x6709;&#x5C42;&#x5B8C;&#x6210;&#x8BA1;&#x7B97;</p>
</li>
<li><p>At any time, the total size of tensors stored on a device cannot exceed its memory capacity.</p>
<p>&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x4E0D;&#x80FD;&#x8D85;&#x8FC7;&#x8BBE;&#x5907;&#x5185;&#x5B58;</p>
</li>
</ul>
</blockquote>
<p><strong>&#x8BA1;&#x7B97;&#x8C03;&#x5EA6;</strong></p>
<blockquote>
<p><img src="FlexGen.assets/2.png" alt="2"></p>
<p>&#x4EE5;&#x5F80;&#x7684;&#x662F;&#x4E00;&#x884C;&#x4E00;&#x884C;&#x7684;&#xFF0C;&#x672C;&#x8BBA;&#x6587;&#x63D0;&#x51FA;&#x7684;&#x662F;&#x4E00;&#x5217;&#x4E00;&#x5217;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x4E86;&#x91CD;&#x590D;&#x52A0;&#x8F7D;model&#x3002;</p>
<p>&#x4F46;&#x4F1A;&#x9762;&#x4E34;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;CPU&#x548C;disk&#x5185;&#x5B58;&#x7684;&#x6709;&#x9650;&#x7684;&#x3002;&#x6240;&#x4EE5;&#x91C7;&#x7528;&#x4E86;&#x56FE;b&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;zig-zag block schedule</p>
<p>Besides, we propose another more advanced and I/O-optimal schedule,</p>
<p>&#x63D0;&#x51FA;&#x4E86;&#x53E6;&#x4E00;&#x79CD;&#x66F4;&#x5148;&#x8FDB;&#x7684;IO&#x4F18;&#x5316;&#x8C03;&#x5EA6;&#xFF0C;&#x4F46;&#x4EC5;&#x5B9E;&#x73B0;&#x4E86;block&#x7684;&#x8C03;&#x5EA6;&#xFF0C;&#x4E14;&#x5728;&#x6587;&#x7AE0;&#x4E2D;&#x6CA1;&#x6709;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#x3002;</p>
<p><img src="FlexGen.assets/3.png" alt="3"></p>
<p>&#x901A;&#x8FC7;&#x5F02;&#x6B65;&#x4F20;&#x8F93;+&#x8BA1;&#x7B97;&#xFF0C;&#x5B9E;&#x73B0;&#x8BA1;&#x7B97;&#x548C;&#x901A;&#x4FE1;&#x91CD;&#x53E0;&#x3002;</p>
</blockquote>
<p><strong>&#x5F20;&#x91CF;&#x653E;&#x7F6E;</strong></p>
<blockquote>
<p>&#x7528;w&#x8868;&#x793A;&#x6743;&#x91CD;&#xFF0C;h&#x8868;&#x793A;&#x6FC0;&#x6D3B;&#x503C;&#xFF0C;c&#x8868;&#x793A;kv cache&#x3002;&#x8BB0;&#x5F55;&#x5728;gpu memory&#x3001;cpu memory&#x548C;disk&#x4E0A;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;</p>
<p>&#x4E14;&#x6709;&#x4E09;&#x4E2A;&#x53EF;&#x4EE5;&#x601D;&#x8003;&#x7684;&#x5206;&#x53D1;&#x89D2;&#x5EA6;</p>
<ul>
<li>model granularity</li>
<li>layer granularity</li>
<li>tensor granularity</li>
</ul>
<p>Coarser granularity leads to lower runtime overhead but it is less &#xFB02;exible and its cost is dif&#xFB01;cult to analyze.</p>
<p>&#x76EE;&#x524D;&#x91C7;&#x7528;layer granularity</p>
</blockquote>
<p><strong>Computation delegation</strong></p>
<blockquote>
<p>the computation of attention scores during decoding is I/O-bounded</p>
<p>CPU&#x8BA1;&#x7B97;the attention score&#x53EF;&#x4EE5;&#x51CF;&#x5C11;IO&#x901A;&#x4FE1;&#xFF0C;&#x6240;&#x4EE5;&#x5047;&#x5982;kv cache&#x8FD8;&#x6CA1;&#x5B58;&#x5230;gpu&#x4E0A;&#x65F6;&#x53EF;&#x4EE5;&#x7528;CPU&#x8FDB;&#x884C;&#x8BA1;&#x7B97;</p>
</blockquote>
<p><strong>&#x6210;&#x672C;&#x6A21;&#x578B;</strong></p>
<blockquote>
<ul>
<li><p>latency</p>
<p>&#x7528;$T<em>{pre}$&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5C42;&#x5728;&#x9884;&#x5904;&#x7406;&#x9636;&#x6BB5;&#x7684;&#x5E73;&#x5747;latency&#xFF0C;$T</em>{gen}$&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5C42;&#x5728;decoding&#x9636;&#x6BB5;&#x7684;&#x5E73;&#x5747;latency</p>
<p>&#x7136;&#x540E;&#x5047;&#x8BBE;&#x5B8C;&#x5168;&#x91CD;&#x53E0;&#xFF0C;&#x90A3;&#x4E48;&#x5E73;&#x5747;latency&#x662F;&#x6570;&#x636E;&#x4ECE;CPU&#x8BFB;&#x5230;GPU&#x3001;GPU&#x5199;&#x5230;CPU&#xFF0C;disk&#x8BFB;&#x5230;CPU&#x3001;CPU&#x5199;&#x5230;disk&#xFF0C;&#x8BA1;&#x7B97; &#x8FD9;&#x4E94;&#x90E8;&#x5206;&#x4E2D;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x901A;&#x4FE1;&#x7684;&#x4F30;&#x8BA1;&#x901A;&#x8FC7;&#x6570;&#x636E;&#x91CF;&#xFF0C;&#x8BA1;&#x7B97;&#x7684;&#x4F30;&#x8BA1;&#x901A;&#x8FC7;&#x8BA1;&#x7B97;&#x4E8B;&#x4EF6;</p>
</li>
<li><p>peak memory usage of the GPU&#x3001;CPU and disk</p>
</li>
</ul>
</blockquote>
<p><strong>&#x641C;&#x7D22;&#x7B56;&#x7565;</strong></p>
<blockquote>
<p>&#x5305;&#x542B;&#x5341;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF1A;block size bls, GPU batch size gbs, weight placement wg, wc, wd, activation placement hg, hc, hd, and KV cache placement cg, cc, cd.</p>
<p>&#x5148;&#x786E;&#x5B9A;vls&#x548C;gbs&#xFF0C;&#x518D;&#x786E;&#x5B9A;wg&#xFF0C;wc&#xFF0C;wd&#xFF0C;hg&#xFF0C;hc&#xFF0C;hd&#xFF0C;cg&#xFF0C;cc&#xFF0C;cd&#x3002;&#x4ECE;&#x800C;&#x51CF;&#x5C11;&#x4E86;&#x641C;&#x7D22;&#x7A7A;&#x95F4;</p>
<p>&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x7EBF;&#x6027;&#x89C4;&#x5212;&#x95EE;&#x9898;</p>
<p><img src="FlexGen.assets/4.png" alt="4"></p>
<p>&#x8003;&#x8651;&#x4E86;&#x5185;&#x5B58;&#x5CF0;&#x503C;&#xFF0C;&#x5CF0;&#x503C;&#x8D85;&#x8FC7;&#x7684;&#x65F6;&#x5019;&#x624B;&#x52A8;&#x8C03;&#x6574;</p>
</blockquote>
<p><strong>&#x62D3;&#x5C55;&#x5230;&#x591A;GPU</strong></p>
<blockquote>
<p>Tensor parallelism can reduce the single-query latency</p>
<p>Pipeline parallelism can achieve good scaling on throughput due to its low communication costs</p>
<p>&#x91C7;&#x7528;&#x4E86;Pipeline parallelism&#x3002;&#x5E76;&#x91C7;&#x7528;&#x5FAE;&#x6279;&#x6B21;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x8FED;&#x4EE3;&#x7EA7;&#x8C03;&#x5EA6;</p>
</blockquote>
<h2 id="approximate-methods">Approximate Methods</h2>
<blockquote>
<p>However, the inference throughput can be greatly boosted with negligible accuracy loss by allowing some approximations, because LLMs are typically robust to careful approximations.</p>
</blockquote>
<p><strong>Group-wise Quantization</strong></p>
<blockquote>
<p>use a &#xFB01;ne-grained group-wise asymmetric quantization method (Shen et al., 2020).</p>
<p>For each group, we compute the min and max of the group elements and quantize each element x into b-bit integers by</p>
<p>$x_{quant}=round(\frac{x-min}{max-min}\times(2^b-1))$</p>
<p>The tensors are stored in the quantized format and converted back to FP16 before computation.</p>
<p>&#x5728;&#x4F20;&#x8F93;&#x524D;&#x8F6C;&#x6362;&#x4E3A;4bit&#x7CBE;&#x5EA6;&#xFF0C;&#x4F20;&#x8F93;&#x540E;&#x8F6C;&#x6362;&#x56DE;&#x6765;&#x518D;&#x8BA1;&#x7B97;&#x3002;&#x5E76;&#x4E14;&#x8BE5;&#x8F6C;&#x6362;&#x4E0D;&#x5728;CPU&#x4E0A;&#x8FD0;&#x884C;</p>
</blockquote>
<p><strong>Sparse Attention.</strong></p>
<blockquote>
<p>&#x81EA;&#x6CE8;&#x610F;&#x529B;&#x6709;&#x7A00;&#x758F;&#x6027;&#xFF0C;&#x53EA;&#x8BA1;&#x7B97;top 10% attention scores</p>
<p>After computing the attention matrices, for each query, we calculate the indices of its Top-K tokens from the K cache. We then simply drop the other tokens and only load a subset of the V cache according to the indices.</p>
<p><a href="https://arxiv.org/html/2312.04985v1" target="_blank">&#x53C2;&#x8003;&#x8D44;&#x6599;</a></p>
<p>&#x5E94;&#x8BE5;&#x662F;<img src="FlexGen.assets/5.png" alt="5">&#x8FD9;&#x4E2A;&#x610F;&#x601D;&#xFF1F;&#x4F46;&#x6CA1;&#x592A;&#x61C2;&#x5177;&#x4F53;&#x7684;&#x8BA1;&#x7B97;&#x3002;</p>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: ICML 2023">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../NSDI 2023/" class="navigation navigation-next " aria-label="Next page: NSDI 2023">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Flex Gen","level":"3.6.1","depth":2,"next":{"title":"NSDI 2023","level":"3.7","depth":1,"path":"Paper Reading Notes/NSDI 2023/index.md","ref":"Paper Reading Notes/NSDI 2023/index.md","articles":[{"title":"Shockwave","level":"3.7.1","depth":2,"path":"Paper Reading Notes/NSDI 2023/Shockwave.md","ref":"Paper Reading Notes/NSDI 2023/Shockwave.md","articles":[]}]},"previous":{"title":"ICML 2023","level":"3.6","depth":1,"path":"Paper Reading Notes/ICML 2023/index.md","ref":"Paper Reading Notes/ICML 2023/index.md","articles":[{"title":"Flex Gen","level":"3.6.1","depth":2,"path":"Paper Reading Notes/ICML 2023/FlexGen.md","ref":"Paper Reading Notes/ICML 2023/FlexGen.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["hide-element","back-to-top-button","chapter-fold","code","splitter","katex","expandable-chapters-small"],"pluginsConfig":{"chapter-fold":{},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"back-to-top-button":{},"expandable-chapters-small":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"Introduction.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Paper Reading Notes/ICML 2023/FlexGen.md","mtime":"2024-12-02T02:35:31.766Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-12-02T02:36:07.078Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

